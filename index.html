<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Apu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- Fonts --- */
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;500;700;800&family=Gloria+Hallelujah&display=swap');
        
        :root {
            --glass-bg: rgba(255, 255, 255, 0.85); 
            --glass-border: rgba(255, 255, 255, 0.9); 
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            overflow-x: hidden; /* Prevent horizontal scroll only */
            background-color: #fdf2f8; 
            perspective: 1000px; 
        }

        /* --- Animated Background --- */
        .gradient-bg {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -2;
            background: radial-gradient(circle at 50% 50%, #fdf4ff, #fae8ff, #ffe4e6, #fff1f2);
            background-size: 200% 200%; 
            animation: gradientMove 15s ease infinite; 
        }
        @keyframes gradientMove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        /* --- Glass Card --- */
        #card-container {
            width: 90%; 
            max-width: 40rem; 
            /* Removed fixed height, added min-height for consistency */
            min-height: 500px; 
            height: auto;
            
            background: var(--glass-bg); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 2rem;
            box-shadow: 0 20px 60px -10px rgba(244, 114, 182, 0.25);
            
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
            
            /* Ensure Flex layout handles content flow */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .handwritten { font-family: 'Gloria Hallelujah', cursive; }

        /* --- Candle Animation --- */
        .flame-wrapper { position: absolute; -top: 24px; left: 50%; transform: translateX(-50%); }
        .flame { 
            width: 12px; height: 24px; 
            background: linear-gradient(to top, #fbbf24, #f59e0b, #fff); 
            border-radius: 50% 50% 30% 30% / 60% 60% 40% 40%;
            transform-origin: center bottom; 
            animation: flicker 0.1s infinite alternate; 
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.6); 
        }
        @keyframes flicker { 
            0% { transform: scale(1) rotate(-2deg); opacity: 0.9; } 
            100% { transform: scale(1.05) rotate(2deg); opacity: 1; } 
        }

        /* --- Particles --- */
        .particle { pointer-events: none; position: absolute; animation: floatUp 15s linear infinite; opacity: 0; }
        @keyframes floatUp {
            0% { transform: translateY(100vh) scale(0.8); opacity: 0; }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% { transform: translateY(-10vh) scale(1.2); opacity: 0; }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="gradient-bg"></div>
    <div id="particle-container"></div>

    <div id="card-container" class="py-12 px-6 md:px-10 text-center">
        
        <div id="content-area" class="w-full flex-grow flex flex-col items-center justify-center transition-all duration-700 opacity-100 transform translate-y-0">
            </div>

        <button id="next-btn" onclick="nextPage()" class="mt-8 opacity-0 transform translate-y-4 transition-all duration-500 disabled:cursor-not-allowed z-20">
            </button>
    </div>

    <script>
        // --- Configuration & Data ---
        let currentState = 0; 
        let messageStep = 0;
        let isTransitioning = false;
        let isTyping = false;
        let candles = [true, true, true];

        // Pure, Supportive Sibling Messages
        const messages = [
            { 
                title: "Hey Apu...", 
                icon: "üëã", 
                text: "I know things are heavy right now. I know you're disappointed. But as your younger brother, I see things differently. I don't see a test result; I see the sister who has always been kind, smart, and amazing." 
            },
            { 
                title: "Just a Speed Bump", 
                icon: "üöß", 
                text: "This exam? It's just a tiny piece of paper in a very long life. It doesn't define your intelligence, and it definitely doesn't define your future. You have so much talent that a grade sheet can't capture." 
            },
            { 
                title: "I Admire You", 
                icon: "üåü", 
                text: "You might not know this, but I look up to you. I watch how you handle things. Your strength inspires me. seeing you sad hurts me too, because I know how brilliant you really are." 
            },
            { 
                title: "The Brother Promise", 
                icon: "ü§û", 
                text: "I'm here. Not just when things are good, but especially now. If you need a distraction, I've got jokes. If you need silence, I'll sit with you. You don't have to carry this burden alone. We are a team." 
            },
            { 
                title: "We Believe in You", 
                icon: "‚ù§Ô∏è", 
                text: "Take all the time you need to heal. But please remember: We believe in you. I believe in you. You're going to bounce back stronger than ever. I'm proud to call you my sister." 
            }
        ];

        // --- Visual Elements ---
        const icons = {
            arrow: `<svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>`,
            reset: `<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>`
        };

        // --- 3D Tilt Effect ---
        const card = document.getElementById('card-container');
        document.addEventListener('mousemove', (e) => {
            if(window.innerWidth > 768) { // Only tilt on desktop to avoid weird mobile scrolls
                const xAxis = (window.innerWidth / 2 - e.pageX) / 30;
                const yAxis = (window.innerHeight / 2 - e.pageY) / 30;
                card.style.transform = `rotateY(${xAxis}deg) rotateX(${yAxis}deg)`;
            }
        });

        // --- Core Functions ---

        function renderContent() {
            const contentDiv = document.getElementById('content-area');
            const btn = document.getElementById('next-btn');
            
            let html = '';
            // Default Button Style
            let btnClass = 'flex items-center px-8 py-3 rounded-full font-bold transition-transform hover:scale-105 active:scale-95 shadow-lg ';
            let btnContent = '';
            let btnAction = nextPage;

            if (currentState === 0) {
                // Welcome Screen
                html = `
                    <div class="mb-6 text-6xl animate-bounce">üíå</div>
                    <h1 class="text-4xl md:text-5xl font-extrabold text-slate-800 mb-6 tracking-tight">
                        Hi Apu.
                    </h1>
                    <p class="text-lg text-slate-600 max-w-sm mx-auto leading-relaxed">
                        I made this little page just for you. To remind you of something important.
                    </p>
                `;
                btnClass += 'bg-gradient-to-r from-pink-400 to-purple-400 text-white';
                btnContent = `Open It ${icons.arrow}`;
            } 
            else if (currentState === 1) {
                // Messages Screen
                const msg = messages[messageStep];
                html = `
                    <div class="mb-6 text-6xl transform transition-transform hover:scale-110 duration-300 cursor-default">${msg.icon}</div>
                    <h2 class="text-2xl md:text-3xl font-bold text-slate-800 mb-6">${msg.title}</h2>
                    
                    <div class="w-full min-h-[6rem] flex items-start justify-center">
                        <p id="typewriter" class="text-xl md:text-2xl handwritten text-slate-600 leading-relaxed max-w-lg"></p>
                    </div>
                `;
                btnClass += 'bg-white text-pink-500 border-2 border-pink-100 hover:bg-pink-50';
                btnContent = messageStep < messages.length - 1 ? `Next ${icons.arrow}` : `One Last Thing ${icons.arrow}`;
            } 
            else if (currentState === 2) {
                // Cake Screen
                const allBlown = candles.every(c => !c);
                html = `
                    <h2 class="text-3xl font-bold text-slate-800 mb-8">
                        ${allBlown ? "Wish Granted! ‚ú®" : "Make a Wish for Happiness"}
                    </h2>
                    
                    <div class="relative mt-4 mb-8 scale-100 md:scale-110">
                        <div class="w-48 h-24 bg-pink-100 border-b-8 border-pink-200 rounded-lg relative z-10 flex items-center justify-center shadow-inner">
                            <span class="text-pink-300 font-black text-2xl tracking-widest opacity-50">HOPE</span>
                        </div>
                        <div class="w-52 h-10 bg-white rounded-full absolute -top-5 left-1/2 transform -translate-x-1/2 z-20 shadow-sm"></div>
                        
                        <div class="absolute -top-16 left-1/2 transform -translate-x-1/2 flex gap-6 z-30">
                            ${candles.map((isOn, i) => `
                                <div class="relative cursor-pointer group p-2" onclick="blowCandle(${i})">
                                    ${isOn ? `<div class="flame-wrapper"><div class="flame"></div></div>` : `<div class="absolute -top-8 left-1/2 -translate-x-1/2 text-2xl animate-pulse opacity-50">üí®</div>`}
                                    <div class="w-4 h-12 bg-gradient-to-b from-purple-200 to-purple-300 rounded shadow-sm"></div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <p class="text-slate-500 text-sm font-medium mt-4">
                        ${allBlown ? "Redirecting..." : "(Tap the flames to blow them out)"}
                    </p>
                `;
                btnClass += ' hidden'; 
            } 
            else if (currentState === 3) {
                // Finale Screen
                html = `
                    <div class="mb-6 text-6xl animate-pulse">üåª</div>
                    <h1 class="text-4xl font-bold text-slate-800 mb-6">Always Here.</h1>
                    <p class="text-xl handwritten text-slate-600 mb-8 leading-relaxed max-w-md mx-auto">
                        "Failure is just an event, not a person. You are still our amazing Apu."
                        <br><br>
                        <span class="text-base font-sans text-pink-400 font-bold">- Your Little Brother</span>
                    </p>
                `;
                btnClass += 'bg-slate-100 text-slate-600 hover:bg-slate-200';
                btnContent = `${icons.reset} Read Again`;
                btnAction = () => location.reload();
            }

            // Inject HTML
            contentDiv.innerHTML = html;
            btn.className = btnClass;
            btn.innerHTML = btnContent;
            btn.onclick = btnAction;

            // Handle Transitions & Typing
            if (currentState === 1) {
                // Ensure button is hidden initially for typewriter
                btn.classList.remove('opacity-100', 'translate-y-0');
                btn.classList.add('opacity-0', 'translate-y-4');
                btn.disabled = true;
                
                // Small delay to let HTML render before typing
                setTimeout(() => typeWriter(messages[messageStep].text, 'typewriter', btn), 100);
            } else if (currentState === 2) {
                // Button hidden logic handled in CSS class
            } else {
                // Show button immediately for Welcome/Finale
                setTimeout(() => {
                    btn.classList.remove('opacity-0', 'translate-y-4');
                    btn.classList.add('opacity-100', 'translate-y-0');
                    btn.disabled = false;
                }, 100);
            }
        }

        async function nextPage() {
            if (isTransitioning || isTyping) return;
            isTransitioning = true;

            const contentDiv = document.getElementById('content-area');
            const btn = document.getElementById('next-btn');

            // Fade Out Content
            contentDiv.classList.add('opacity-0', 'translate-y-4');
            btn.classList.add('opacity-0', 'translate-y-4');
            
            await new Promise(r => setTimeout(r, 600));

            // State Update Logic
            if (currentState === 0) currentState = 1;
            else if (currentState === 1) {
                if (messageStep < messages.length - 1) messageStep++;
                else currentState = 2;
            }

            renderContent();

            // Fade In Content
            contentDiv.classList.remove('opacity-0', 'translate-y-4');
            
            isTransitioning = false;
        }

        // --- Typewriter Effect ---
        function typeWriter(text, elementId, btn) {
            const el = document.getElementById(elementId);
            if (!el) return;
            
            isTyping = true;
            el.innerHTML = ''; // Clear previous text immediately
            let i = 0;
            const speed = 20; // Typing speed (lower is faster)
            
            function type() {
                if (i < text.length) {
                    el.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                } else {
                    isTyping = false;
                    // Reveal Button Only After Typing Finishes
                    btn.classList.remove('opacity-0', 'translate-y-4');
                    btn.classList.add('opacity-100', 'translate-y-0');
                    btn.disabled = false;
                }
            }
            type();
        }

        // --- Candle Logic ---
        function blowCandle(index) {
            if (candles[index]) {
                candles[index] = false;
                renderContent(); // Re-render to show smoke
                
                if (candles.every(c => !c)) {
                    fireConfetti();
                    setTimeout(() => {
                        currentState = 3;
                        nextPage(); // Move to finale
                    }, 2000);
                }
            }
        }

        // --- Background Particles ---
        function initParticles() {
            const container = document.getElementById('particle-container');
            const emojis = ['ü§ç', '‚ú®', 'üå∏', '‚òÅÔ∏è'];
            for (let i = 0; i < 20; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.innerText = emojis[Math.floor(Math.random() * emojis.length)];
                p.style.left = Math.random() * 100 + 'vw';
                p.style.animationDuration = (Math.random() * 10 + 15) + 's';
                p.style.animationDelay = (Math.random() * -15) + 's';
                p.style.fontSize = (Math.random() * 1 + 1) + 'rem';
                container.appendChild(p);
            }
        }

        function fireConfetti() {
            const colors = ['#f472b6', '#c084fc', '#fbbf24', '#ffffff'];
            for (let i = 0; i < 50; i++) {
                const conf = document.createElement('div');
                conf.style.position = 'absolute'; 
                conf.style.width = '8px'; conf.style.height = '8px';
                conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                conf.style.left = '50%'; conf.style.top = '50%';
                document.body.appendChild(conf);
                
                const angle = Math.random() * Math.PI * 2;
                const velocity = Math.random() * 300 + 100;
                
                conf.animate([
                    { transform: 'translate(-50%, -50%)', opacity: 1 },
                    { transform: `translate(calc(-50% + ${Math.cos(angle) * velocity}px), calc(-50% + ${Math.sin(angle) * velocity}px))`, opacity: 0 }
                ], { duration: 1500, easing: 'ease-out' }).onfinish = () => conf.remove();
            }
        }

        // Start
        initParticles();
        renderContent();

    </script>
</body>
  </html>
  
